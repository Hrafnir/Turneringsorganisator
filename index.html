<!-- Version: #22 -->
<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Turneringssjefen v22.0</title>
    <link rel="icon" href="data:,">
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>

    <!-- WINNER OVERLAY -->
    <div id="winnerOverlay" class="winner-overlay hidden" onclick="closeWinner()">
        <div class="confetti"></div>
        <div class="trophy-container">
            <i class="fas fa-trophy trophy-icon"></i>
            <h1>VINNEREN ER K√ÖRET!</h1>
            <h2 id="winnerText">LAG NAVN</h2>
            <p>(Klikk for √• lukke)</p>
        </div>
    </div>

    <!-- MAIN APP WRAPPER -->
    <div id="app">
        
        <!-- NAVIGATION (Skjules p√• print) -->
        <nav class="no-print">
            <div class="logo-area">
                <div class="logo">üèÜ <span id="displayTitle">Turnering</span> <span class="version">v22.0</span></div>
                <input type="text" id="tournamentTitleInput" placeholder="Navn p√• turnering..." onchange="updateTitle(this.value)" class="title-input">
            </div>
            
            <div class="nav-actions">
                <div class="file-controls">
                    <button onclick="saveToFile()" class="btn-small-blue"><i class="fas fa-download"></i> Backup</button>
                    <label class="btn-small-blue">
                        <i class="fas fa-upload"></i> Last inn
                        <input type="file" id="fileInput" onchange="loadFromFile()" style="display:none;">
                    </label>
                </div>
                <button onclick="confirmReset()" class="btn-small-red"><i class="fas fa-trash"></i> Nullstill</button>
            </div>
        </nav>

        <!-- TABS (Skjules p√• print) -->
        <div class="tabs-bar no-print">
            <button onclick="showTab('setup')" class="active">1. Elever</button>
            <button onclick="showTab('arena')">2. Arena</button>
            <button onclick="showTab('draw')">3. Lag</button>
            <button onclick="showTab('schedule')">4. Kamper & Resultater</button>
            <button onclick="showTab('control')" class="tab-highlight">5. KAMPSTYRING</button>
            <button onclick="showTab('finals')">6. Tabell & Finale</button>
        </div>

        <!-- TAB 1: OPPSETT -->
        <div id="setup" class="tab-content active no-print">
            <div class="container">
                <h2>1. Registrering av Elever</h2>
                <div class="setup-grid">
                    <div class="input-section">
                        <div class="class-input-row">
                            <input type="text" id="newClassInput" placeholder="Ny klasse..." style="width:150px;">
                            <button onclick="addClass()" class="btn-green">Opprett</button>
                        </div>
                        <label>Velg klasse for import:</label>
                        <div id="classButtons" class="class-buttons"></div>
                        <textarea id="pasteArea" placeholder="Lim inn navneliste fra Excel her..."></textarea>
                        <button onclick="addStudents()" class="btn-primary block-btn">Legg til elever</button>
                    </div>
                    <div class="list-section">
                        <div class="header-row">
                            <h3>P√•meldte (<span id="studentCount">0</span>)</h3>
                            <input type="text" id="studentSearch" placeholder="üîç S√∏k..." onkeyup="renderStudentList()" class="search-input">
                        </div>
                        <p class="small-info">Fjern haken ved eleven for √• markere som frav√¶rende.</p>
                        <div id="studentList" class="student-grid"></div>
                        <button onclick="clearStudents()" class="btn-text-red" style="margin-top:10px;">Slett alle elever</button>
                    </div>
                </div>
                <div class="footer-actions">
                    <button class="btn-primary" onclick="showTab('arena')">Neste <i class="fas fa-arrow-right"></i></button>
                </div>
            </div>
        </div>

        <!-- TAB 2: ARENA -->
        <div id="arena" class="tab-content no-print">
            <div class="container">
                <h2>2. Baner og Innstillinger</h2>
                <div class="config-grid">
                    <div class="config-box">
                        <h3>üèüÔ∏è Baner og Aktiviteter</h3>
                        <p class="small-info">Skriv inn aktivitet (eks: "Volleyball", "Sjakk", "Bordtennis").</p>
                        <div id="courtList"></div>
                        <button onclick="addCourt()" class="btn-green-outline">+ Legg til bane</button>
                    </div>
                    <div class="config-box">
                        <h3>‚öôÔ∏è Tidsplan & Runder</h3>
                        <div class="form-row"><label>Starttid:</label><input type="time" id="startTime" value="10:15"></div>
                        <div class="form-row"><label>Finalestart:</label><input type="time" id="finalsTime" value="14:00"></div>
                        <div class="form-row"><label>Kamp (min):</label><input type="number" id="matchDuration" value="15"></div>
                        <div class="form-row"><label>Pause (min):</label><input type="number" id="breakDuration" value="5"></div>
                        <hr style="border:0; border-top:1px solid #444; margin:15px 0;">
                        <div class="form-row">
                            <label style="color:var(--accent); font-weight:bold;">Antall runder:</label>
                            <input type="number" id="roundsCount" value="10" style="border-color:var(--accent);">
                        </div>
                        <p class="small-info">Algoritmen balanserer b√•de totalt antall kamper og antall kamper per aktivitet.</p>
                    </div>
                </div>
                <div class="footer-actions">
                    <button class="btn-primary" onclick="showTab('draw')">Neste <i class="fas fa-arrow-right"></i></button>
                </div>
            </div>
        </div>

        <!-- TAB 3: LAGINNDELING -->
        <div id="draw" class="tab-content">
            <div class="container">
                <div class="print-header">
                    <h1 id="printTitleTeams">Lister</h1>
                </div>

                <div class="no-print">
                    <h2>3. Generer Lag</h2>
                    <div class="draw-controls">
                        <div class="draw-option">
                            <label>Fordeling:</label>
                            <select id="drawStrategy" onchange="toggleCustomMix()">
                                <option value="balanced">‚öñÔ∏è Perfekt Miks (Jevn)</option>
                                <option value="class_based">üè´ Klassevis</option>
                                <option value="ab_cd">üÖ∞Ô∏èüÖ±Ô∏è Base-miks</option>
                                <option value="custom">üõ†Ô∏è Egendefinert</option>
                                <option value="random">üé≤ Kaos</option>
                            </select>
                        </div>
                        
                        <div id="customMixPanel" class="hidden custom-mix-panel">
                            <p>Pulje 1 (resten til Pulje 2):</p>
                            <div id="customClassCheckboxes" class="checkbox-group"></div>
                        </div>

                        <div class="draw-option">
                            <label>Antall lag:</label>
                            <input type="number" id="teamCount" value="12" style="width:60px;">
                        </div>

                        <button class="btn-primary" onclick="generateTeams()">‚ö° Generer</button>
                        <button class="btn-grey" onclick="window.print()"><i class="fas fa-print"></i> Skriv ut Laglister</button>
                        <button id="lockBtn" class="btn-yellow" onclick="toggleLockTeams()"><i class="fas fa-unlock"></i> √Öpen</button>
                    </div>
                    <p class="info-text">Dra og slipp elever for √• endre lag manuelt.</p>
                </div>
                
                <div id="drawDisplay" class="draw-grid"></div>
                
                <div class="generate-section no-print">
                    <button class="btn-spectacular" onclick="generateSchedule()">üìÖ Generer Kampoppsett</button>
                </div>
            </div>
        </div>

        <!-- TAB 4: KAMPPLAN & RESULTATER -->
        <div id="schedule" class="tab-content">
            <div class="container">
                <div class="print-header">
                    <h1>Kampoppsett</h1>
                </div>

                <div class="schedule-actions no-print">
                    <button onclick="window.print()" class="btn-grey"><i class="fas fa-print"></i> Skriv ut Oppsett</button>
                    <button onclick="addManualMatch()" class="btn-text">+ Ekstra kamp</button>
                    <button onclick="clearSchedule()" class="btn-text-red">Slett oppsett</button>
                </div>

                <div id="scheduleContainer"></div>
            </div>
        </div>

        <!-- TAB 5: KAMPSTYRING -->
        <div id="control" class="tab-content no-print">
            <div class="control-panel-wrapper">
                <h1>KAMPSTYRING</h1>
                <div class="timer-box">
                    <div id="mainTimer">15:00</div>
                </div>
                <div class="control-buttons">
                    <button onclick="timerStart()" class="btn-ctrl btn-green"><i class="fas fa-play"></i> START</button>
                    <button onclick="timerPause()" class="btn-ctrl btn-yellow"><i class="fas fa-pause"></i> PAUSE</button>
                    <button onclick="timerReset()" class="btn-ctrl btn-red"><i class="fas fa-undo"></i> RESET</button>
                </div>
                <div class="sound-buttons">
                    <button onclick="playHornLong()" class="btn-sound large">üì¢ LANGT SIGNAL</button>
                    <button onclick="playHornShort()" class="btn-sound">üîî KORT SIGNAL</button>
                </div>
                <div class="manual-adjust">
                    <button onclick="adjustTimer(1)" class="btn-small-grey">+1 Min</button>
                    <button onclick="adjustTimer(-1)" class="btn-small-grey">-1 Min</button>
                </div>
            </div>
        </div>

        <!-- TAB 6: TABELL & FINALE -->
        <div id="finals" class="tab-content no-print">
            <div class="container">
                <h2>Tabell</h2>
                <table class="leaderboard-table">
                    <thead><tr><th>#</th><th>Lag</th><th>K</th><th>S</th><th>U</th><th>T</th><th>MF</th><th>Poeng</th></tr></thead>
                    <tbody id="leaderboardBody"></tbody>
                </table>

                <div class="finals-section">
                    <h2>Finale & Plassering</h2>
                    <div class="final-setup-row">
                        <label>Lag A:</label><select id="finalTeam1"></select>
                        <label>Lag B:</label><select id="finalTeam2"></select>
                        <label>Navn:</label><input type="text" id="finalName" value="Gullfinale">
                        <button onclick="createFinalMatch()" class="btn-primary">Opprett Finale</button>
                    </div>
                    
                    <div id="finalsList" class="finals-list"></div>
                </div>
            </div>
        </div>

    </div>

    <script src="script.js"></script>
</body>
</html>
<!-- Version: #22 -->
