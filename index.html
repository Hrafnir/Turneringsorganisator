<!-- Version: #17 -->
<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Turneringssjefen - Stabil v17</title>
    <link rel="icon" href="data:,">
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>

    <!-- WINNER OVERLAY -->
    <div id="winnerOverlay" class="winner-overlay hidden" onclick="closeWinner()">
        <div class="confetti"></div>
        <div class="trophy-container">
            <i class="fas fa-trophy trophy-icon"></i>
            <h1>VINNEREN ER K√ÖRET!</h1>
            <h2 id="winnerText">LAG NAVN</h2>
            <p>(Klikk for √• lukke)</p>
        </div>
    </div>

    <!-- MAIN APP WRAPPER -->
    <div id="app">
        
        <!-- NAVIGATION (Skjules p√• print) -->
        <nav class="no-print">
            <div class="logo-area">
                <div class="logo">üèÜ <span id="displayTitle">Turnering</span> <span class="version">v17.0 (Manuell)</span></div>
                <input type="text" id="tournamentTitleInput" placeholder="Navn p√• turnering..." onchange="updateTitle(this.value)" class="title-input">
            </div>
            
            <div class="nav-actions">
                <div class="file-controls">
                    <button onclick="saveToFile()" class="btn-small-blue"><i class="fas fa-download"></i> Backup (Fil)</button>
                    <label class="btn-small-blue">
                        <i class="fas fa-upload"></i> Last inn
                        <input type="file" id="fileInput" onchange="loadFromFile()" style="display:none;">
                    </label>
                </div>
                <button onclick="confirmReset()" class="btn-small-red"><i class="fas fa-trash"></i> Nullstill Alt</button>
            </div>
        </nav>

        <!-- TABS (Skjules p√• print) -->
        <div class="tabs-bar no-print">
            <button onclick="showTab('setup')" class="active">1. Elever</button>
            <button onclick="showTab('arena')">2. Arena</button>
            <button onclick="showTab('draw')">3. Lag</button>
            <button onclick="showTab('schedule')">4. Kampplan (Print)</button>
            <button onclick="showTab('control')" class="tab-highlight">5. KAMPSTYRING (Klokke)</button>
            <button onclick="showTab('results')">6. Resultater</button>
            <button onclick="showTab('finals')">7. Tabell & Finale</button>
        </div>

        <!-- TAB 1: OPPSETT -->
        <div id="setup" class="tab-content active no-print">
            <div class="container">
                <h2>1. Registrering av Elever</h2>
                <div class="setup-grid">
                    <div class="input-section">
                        <div class="class-input-row">
                            <input type="text" id="newClassInput" placeholder="Ny klasse (eks 10E)..." style="width:150px;">
                            <button onclick="addClass()" class="btn-green">Opprett Klasse</button>
                        </div>
                        <label>Velg klasse for import:</label>
                        <div id="classButtons" class="class-buttons"></div>
                        <textarea id="pasteArea" placeholder="Lim inn navneliste fra Excel her..."></textarea>
                        <button onclick="addStudents()" class="btn-primary block-btn">Legg til elever</button>
                    </div>
                    <div class="list-section">
                        <div class="header-row">
                            <h3>P√•meldte (<span id="studentCount">0</span>)</h3>
                            <input type="text" id="studentSearch" placeholder="üîç S√∏k for √• slette/endre..." onkeyup="renderStudentList()" class="search-input">
                        </div>
                        <p class="small-info">Fjern haken ved eleven for √• markere som frav√¶rende (blir ikke med p√• lag).</p>
                        <div id="studentList" class="student-grid"></div>
                        <button onclick="clearStudents()" class="btn-text-red" style="margin-top:10px;">Slett alle elever</button>
                    </div>
                </div>
                <div class="footer-actions">
                    <button class="btn-primary" onclick="showTab('arena')">Neste: Arena & Regler <i class="fas fa-arrow-right"></i></button>
                </div>
            </div>
        </div>

        <!-- TAB 2: ARENA -->
        <div id="arena" class="tab-content no-print">
            <div class="container">
                <h2>2. Baner og Innstillinger</h2>
                <div class="config-grid">
                    <div class="config-box">
                        <h3>üèüÔ∏è Baner (Aktiviteter)</h3>
                        <p class="small-info">Legg til en bane for hver aktivitet som foreg√•r samtidig.</p>
                        <div id="courtList"></div>
                        <button onclick="addCourt()" class="btn-green-outline">+ Legg til bane</button>
                    </div>
                    <div class="config-box">
                        <h3>‚öôÔ∏è Generelt</h3>
                        <div class="form-row">
                            <label>Veiledende Starttid:</label>
                            <input type="time" id="startTime" value="10:15">
                        </div>
                        <div class="form-row">
                            <label>Veiledende Finalestart:</label>
                            <input type="time" id="finalsTime" value="14:00">
                        </div>
                        <div class="form-row">
                            <label>Kampvarighet (min):</label>
                            <input type="number" id="matchDuration" value="15">
                        </div>
                        <div class="form-row">
                            <label>Pause mellom kamper (min):</label>
                            <input type="number" id="breakDuration" value="5">
                        </div>
                    </div>
                </div>
                <div class="footer-actions">
                    <button class="btn-primary" onclick="showTab('draw')">Neste: Laginndeling <i class="fas fa-arrow-right"></i></button>
                </div>
            </div>
        </div>

        <!-- TAB 3: LAGINNDELING -->
        <div id="draw" class="tab-content no-print">
            <div class="container">
                <h2>3. Generer Lag</h2>
                <div class="draw-controls">
                    <div class="draw-option">
                        <label>Fordelingsmetode:</label>
                        <select id="drawStrategy" onchange="toggleCustomMix()">
                            <option value="balanced">‚öñÔ∏è Perfekt Miks (Jevn fordeling)</option>
                            <option value="class_based">üè´ Klassevis (Rene klasselag)</option>
                            <option value="ab_cd">üÖ∞Ô∏èüÖ±Ô∏è Base-miks (A+B mot C+D)</option>
                            <option value="custom">üõ†Ô∏è Egendefinert miks</option>
                            <option value="random">üé≤ Fullt Kaos (Tilfeldig)</option>
                        </select>
                    </div>
                    
                    <div id="customMixPanel" class="hidden custom-mix-panel">
                        <p>Velg klasser til Pulje 1 (resten havner i Pulje 2):</p>
                        <div id="customClassCheckboxes" class="checkbox-group"></div>
                    </div>

                    <div class="draw-option">
                        <label>Antall lag:</label>
                        <input type="number" id="teamCount" value="12" style="width:60px;">
                    </div>

                    <button class="btn-primary" onclick="generateTeams()">‚ö° Generer Lag</button>
                    <button id="lockBtn" class="btn-yellow" onclick="toggleLockTeams()"><i class="fas fa-unlock"></i> √Öpen for redigering</button>
                </div>
                
                <p class="info-text">Tips: Du kan dra og slippe elever mellom lagene hvis du vil justere manuelt.</p>
                <div id="drawDisplay" class="draw-grid"></div>
                
                <div class="generate-section">
                    <button class="btn-spectacular" onclick="generateSchedule()">üìÖ Generer Kampoppsett (Neste steg)</button>
                </div>
            </div>
        </div>

        <!-- TAB 4: KAMPPLAN & PRINT -->
        <div id="schedule" class="tab-content">
            <div class="container print-container">
                <div class="print-header">
                    <h1 id="printTitle">Kampoppsett</h1>
                    <p>Noter resultater manuelt hvis det digitale systemet svikter.</p>
                </div>

                <div class="schedule-actions no-print">
                    <button onclick="window.print()" class="btn-grey"><i class="fas fa-print"></i> Skriv ut Dommerkort/Oppsett</button>
                    <button onclick="clearSchedule()" class="btn-text-red">Slett oppsettet</button>
                </div>

                <div id="scheduleContainer"></div>
            </div>
        </div>

        <!-- TAB 5: KAMPSTYRING (MANUELL KLOKKE) -->
        <div id="control" class="tab-content no-print">
            <div class="control-panel-wrapper">
                <h1>KAMPSTYRING</h1>
                <p>Denne siden brukes for √• styre tiden i hallen. Start/Stopp manuelt.</p>
                
                <div class="timer-box">
                    <div id="mainTimer">15:00</div>
                </div>

                <div class="control-buttons">
                    <button onclick="timerStart()" class="btn-ctrl btn-green"><i class="fas fa-play"></i> START</button>
                    <button onclick="timerPause()" class="btn-ctrl btn-yellow"><i class="fas fa-pause"></i> PAUSE</button>
                    <button onclick="timerReset()" class="btn-ctrl btn-red"><i class="fas fa-undo"></i> RESET</button>
                </div>

                <div class="sound-buttons">
                    <button onclick="playHornLong()" class="btn-sound large">üì¢ LANGT SIGNAL (SLUTT)</button>
                    <button onclick="playHornShort()" class="btn-sound">üîî KORT SIGNAL (START)</button>
                </div>

                <div class="manual-adjust">
                    <button onclick="adjustTimer(1)" class="btn-small-grey">+1 Min</button>
                    <button onclick="adjustTimer(-1)" class="btn-small-grey">-1 Min</button>
                </div>
            </div>
        </div>

        <!-- TAB 6: RESULTATER -->
        <div id="results" class="tab-content no-print">
            <div class="container">
                <h2>Registrer Resultater</h2>
                <p>Her taster du inn resultatene fortl√∏pende.</p>
                <div id="resultsContainer"></div>
            </div>
        </div>

        <!-- TAB 7: TABELL & FINALE -->
        <div id="finals" class="tab-content no-print">
            <div class="container">
                <h2>Tabell</h2>
                <table class="leaderboard-table">
                    <thead><tr><th>#</th><th>Lag</th><th>K</th><th>S</th><th>U</th><th>T</th><th>MF</th><th>Poeng</th></tr></thead>
                    <tbody id="leaderboardBody"></tbody>
                </table>

                <div class="finals-section">
                    <h2>Finale & Plassering</h2>
                    <div class="final-setup-row">
                        <label>Lag A:</label><select id="finalTeam1"></select>
                        <label>Lag B:</label><select id="finalTeam2"></select>
                        <label>Navn:</label><input type="text" id="finalName" value="Gullfinale">
                        <button onclick="createFinalMatch()" class="btn-primary">Opprett Finale</button>
                    </div>
                    
                    <div id="finalsList" class="finals-list"></div>
                </div>
            </div>
        </div>

    </div>

    <script src="script.js"></script>
</body>
</html>
<!-- Version: #17 -->
